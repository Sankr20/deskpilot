# DeskPilot Threat Model## ScopeDeskPilot is a Windows desktop UI automation tool (engine + CLI + recorder + testkit) that:- captures screenshots for diagnostics- uses OCR/template matching for verification and targeting- can drive user-like input (click/type/paste)This document covers threats relevant to DeskPilot itself and its default behaviors.## Assets to Protect1. **User workstation integrity**   - Prevent unintended automation actions against the wrong app/window.2. **Confidential data in artifacts**   - Screenshots, OCR dumps, overlays, and logs can contain PII/secrets.3. **Project filesystem integrity**   - Init/recorder should not write outside intended directories.4. **Supply chain trust**   - Dependencies and releases should be verifiable and monitored for known CVEs.## Trust Boundaries- **CLI input boundary**: flags, environment variables, CWD, config files.- **Filesystem boundary**: `runs/` outputs, generated tests, temp folders.- **OS boundary**: window selection, focus, clipboard, screenshot capture.- **Dependency boundary**: native bridges (Win32/JNA), OCR/image libs, Maven plugins.- **Distribution boundary**: release zips, scripts, future Maven Central artifacts.## Threats (High-Level)### T1: Sensitive data leakage via artifactsArtifacts may capture credentials, client data, or private communications.- Primary vectors: `runs/` folders, CI artifacts, accidental git commits.### T2: Arbitrary file write / path traversal in init/recorderPoor path handling could overwrite files outside intended project roots.### T3: Unsafe automation / wrong window focusAutomation could click/type into the wrong application, causing data loss or exfiltration.### T4: Supply chain compromiseDependency vulnerabilities or tampered releases could lead to compromise.### T5: Resource exhaustion / DoSLarge images or repeated OCR could cause CPU/memory spikes and unbounded artifact growth.## Non-Goals (Out of Scope)- Malware resistance on already-compromised machines.- Full sandboxing of automation (DeskPilot must interact with OS UI by design).- Preventing intentional misuse by a malicious user (we focus on safe defaults and guardrails).## Mitigation Strategy- **Docs + safe defaults**: warn clearly and ignore artifacts by default in generated projects.- **Guardrails**: confirm selected target window; optionally scope-lock actions.- **Hard limits**: cap retries/timeouts/artifact counts.- **Supply chain hygiene**: automated dependency scanning, SBOM generation, release checksums/signing.## Assumptions- Users may run against sensitive apps; artifacts must be treated as confidential.- Users may run in CI; CI defaults must discourage artifact publication.- Windows UI automation is inherently powerful; safety must be configurable but enabled by default.